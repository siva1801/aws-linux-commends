import boto3

INSTANCE_ID = 'i-0abc12345def67890'  # Replace with your instance ID
NEW_INSTANCE_TYPE = 't3.micro'       # Replace with your target instance type

ec2 = boto3.client('ec2')

def lambda_handler(event, context):
    # Stop instance
    print(f"Stopping instance: {INSTANCE_ID}")
    ec2.stop_instances(InstanceIds=[INSTANCE_ID])
    waiter = ec2.get_waiter('instance_stopped')
    waiter.wait(InstanceIds=[INSTANCE_ID])
    
    # Modify instance type
    print(f"Modifying instance type to {NEW_INSTANCE_TYPE}")
    ec2.modify_instance_attribute(
        InstanceId=INSTANCE_ID,
        InstanceType={'Value': NEW_INSTANCE_TYPE}
    )

    # Start instance
    print(f"Starting instance: {INSTANCE_ID}")
    ec2.start_instances(InstanceIds=[INSTANCE_ID])

    return {
        'statusCode': 200,
        'body': f'Instance {INSTANCE_ID} changed to {NEW_INSTANCE_TYPE} and restarted.'
    }
